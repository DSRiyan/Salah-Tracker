<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Salah Tracker</title>

  <!-- Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>


  <style>
    :root {
      --bg1: #f7efe3;
      --bg2: #fae6c8;
      --card: rgba(255, 255, 255, 0.92);
      --accent: #a06c2a;
      --accent2: #d7a868;
      --text: #3a2b14;
      --muted: #6c5431;
      --danger: #d9534f;
      --glow: rgba(206, 162, 83, 0.5);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(150deg, var(--bg1), var(--bg2));
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 25px;
      color: var(--text);
    }

    .container {
      width: 100%;
      max-width: 420px;
      background: var(--card);
      padding: 22px;
      border-radius: 20px;
      box-shadow: 0 18px 40px rgba(50, 35, 10, 0.18);
    }

    header {
      margin-bottom: 10px;
      text-align: center;
    }

    #title {
      font-size: 26px;
      font-weight: 700;
    }

    #todayDate {
      text-align: center;
      color: var(--muted);
      font-size: 15px;
      margin-top: 5px;
      margin-bottom: 10px;
    }

    /* DATE PICKER BOX */
    .dateBox {
      background: white;
      border: 1px solid var(--accent);
      border-radius: 10px;
      padding: 12px;
      margin-top: 12px;
      margin-bottom: 15px;
      box-shadow: 0 6px 18px rgba(100, 70, 20, 0.07);
      cursor: pointer;
    }

    .dateBox:hover {
      transform: translateY(-3px);
      transition: 0.2s;
    }

    #datePicker {
      width: 100%;
      font-size: 18px;
      border: none;
      outline: none;
      color: var(--accent);
      background: transparent;
      cursor: pointer;
    }

    /* PRAYER BOXES */
    .prayer-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px;
      background: white;
      border: 1px solid var(--accent);
      border-radius: 10px;
      margin-top: 15px;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(100, 70, 10, 0.08);
      position: relative;
      transition: 0.18s;
    }

    .prayer-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 26px rgba(100, 70, 20, 0.14);
    }

    input[type="checkbox"] {
      transform: scale(1.3);
      accent-color: var(--accent);
      cursor: pointer;
    }

    /* Heart Animation */
    .heart {
      position: absolute;
      right: 50%;
      transform: translateX(50%);
      animation: floatUp 1.2s forwards;
      font-size: 22px;
      pointer-events: none;
    }

    @keyframes floatUp {
      0% { opacity: 0; transform: translateY(10px) scale(.9); }
      40% { opacity: 1; }
      100% { opacity: 0; transform: translateY(-36px) scale(1.2); }
    }

    /* Missed */
    .missedMsg {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      animation: floatMiss 1.2s forwards;
      pointer-events: none;
      color: var(--danger);
      font-size: 16px;
    }

    @keyframes floatMiss {
      0% { opacity: 0; transform: translateY(10px) scale(.9); }
      40% { opacity: 1; }
      100% { opacity: 0; transform: translateY(-36px) scale(1.1); }
    }

    .btn {
      width: 100%;
      padding: 12px;
      margin-top: 16px;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      color: white;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 8px 26px rgba(90, 60, 10, 0.15);
    }

    #resetBtn {
      background: linear-gradient(135deg, #bb4a4a, #e98d8d);
    }

    .glowBox {
      box-shadow: 0 0 40px 10px var(--glow) inset;
    }

    .qazaNote {
      margin-top: 10px;
      font-size: 12px;
      color: var(--muted);
      text-align: center;
      font-weight: 700;
      letter-spacing: 1px;
    }

    /* NAME POPUP */
    #namePopup {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.45);
      backdrop-filter: blur(6px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .glassCard {
      width: 90%;
      max-width: 350px;
      padding: 24px;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(14px);
      border: 1px solid rgba(255, 255, 255, 0.5);
      text-align: center;
      color: var(--text);
      box-shadow: 0 10px 35px rgba(0, 0, 0, 0.25);
      animation: popIn 0.35s ease;
    }

    @keyframes popIn {
      from { opacity: 0; transform: scale(0.85); }
      to { opacity: 1; transform: scale(1); }
    }

    .nameInput {
      width: 100%;
      padding: 12px;
      margin-top: 14px;
      border-radius: 12px;
      border: none;
      outline: none;
      font-size: 18px;
      background: rgba(255,255,255,0.80);
    }

    /* REMINDER POPUP */
    #reminderPopup {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9998;
      backdrop-filter: blur(5px);
    }

    .reminderCard {
      width: 90%;
      max-width: 350px;
      background: white;
      border-radius: 18px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
      animation: popIn 0.35s ease;
    }

    .reminderCard h3 {
      color: var(--accent);
      margin-bottom: 10px;
    }

  </style>
</head>

<body>

  <div id="namePopup">
    <div class="glassCard">
      <h2>Assalamu Alaikum!</h2>
      <p>Please enter your good name</p>
      <input class="nameInput" id="userNameInput" placeholder="e.g., Riyan">
      <button class="btn" style="margin-top:14px" onclick="saveUserName()">Continue</button>
    </div>
  </div>

  <!-- Quran + Hadith Popup -->
  <div id="reminderPopup">
    <div class="reminderCard">
      <h3>Quran Reminder</h3>
      <p id="quranText"></p>

      <h3 style="margin-top:15px;">Hadith Reminder</h3>
      <p id="hadithText"></p>

      <button class="btn" style="margin-top:12px;" onclick="closeReminder()">JazakAllah Khair</button>
    </div>
  </div>

  <div class="container">
    <header>
      <div id="title">Salah Tracker</div>
      <div id="todayDate"></div>
    </header>

    <!-- DATE PICKER -->
    <div class="dateBox" onclick="document.getElementById('datePicker').showPicker()">
      <input type="date" id="datePicker">
    </div>

    <!-- PRAYER ITEMS (UNCHANGED) -->
    <div class="prayer-item" onclick="togglePrayer('fajr', this, event)">
      <label>Fajr</label>
      <input type="checkbox" id="fajr">
    </div>

    <div class="prayer-item" onclick="togglePrayer('dhuhr', this, event)">
      <label id="dhuhrLabel">Dhuhr</label>
      <input type="checkbox" id="dhuhr">
    </div>

    <div class="prayer-item" onclick="togglePrayer('asr', this, event)">
      <label>Asr</label>
      <input type="checkbox" id="asr">
    </div>

    <div class="prayer-item" onclick="togglePrayer('maghrib', this, event)">
      <label>Maghrib</label>
      <input type="checkbox" id="maghrib">
    </div>

    <div class="prayer-item" onclick="togglePrayer('isha', this, event)">
      <label>Isha</label>
      <input type="checkbox" id="isha">
    </div>

    <button id="resetBtn" class="btn" onclick="resetDay()">Save Record</button>
    <button class="btn" onclick="openHistory()">View History</button>

    <div class="qazaNote">Whoever forgets a prayer or sleeps and misses it, let him pray it when he remembers it</div>
  </div>

  <script>
    /* Show Today's Date */
    document.getElementById("todayDate").textContent =
      new Date().toLocaleDateString("en-IN", { weekday: "long", month: "long", day: "numeric" });

    /* NAME POPUP HANDLING */
    window.onload = () => {
      let name = localStorage.getItem("userName");
      if (!name) {
        document.getElementById("namePopup").style.display = "flex";
      } else {
        applyName(name);
        showReminder();
      }
    };

    function saveUserName() {
      let name = document.getElementById("userNameInput").value.trim();
      if (!name) return;

      localStorage.setItem("userName", name);
      applyName(name);

      document.getElementById("namePopup").style.display = "none";
      showReminder();
    }

    function applyName(name) {
      document.getElementById("title").textContent = `${name} Salah Tracker`;
    }

    /* QURAN + HADITH REMINDER */
const quranQuotes = [
  "Indeed, in the remembrance of Allah do hearts find rest. (Quran 13:28)",
  "And establish prayer for My remembrance. (Quran 20:14)",
  "So remember Me; I will remember you. (Quran 2:152)"
];

const hadithQuotes = [
  "The first matter that the slave will be brought to account for on the Day of Judgment is the prayer.",
  "Whoever prays Fajr is under the protection of Allah.",
  "Between a man and disbelief is abandoning the Salah."
];

function showReminder() {
  const today = new Date().toISOString().slice(0, 10);
  let reminderData = JSON.parse(localStorage.getItem("dailyReminder") || "{}");

  if (reminderData.date !== today) {
    // Pick new Quran and Hadith
    reminderData = {
      date: today,
      quran: quranQuotes[Math.floor(Math.random() * quranQuotes.length)],
      hadith: hadithQuotes[Math.floor(Math.random() * hadithQuotes.length)]
    };
    localStorage.setItem("dailyReminder", JSON.stringify(reminderData));
  }

  document.getElementById("quranText").textContent = reminderData.quran;
  document.getElementById("hadithText").textContent = reminderData.hadith;
  document.getElementById("reminderPopup").style.display = "flex";
}

function closeReminder() {
  document.getElementById("reminderPopup").style.display = "none";
}

    /* AUTO CHANGE DHUHR â†’ JUMMAH */
    function updateJummahLabel(dateStr) {
      let d = new Date(dateStr);
      document.getElementById("dhuhrLabel").textContent =
        d.getDay() === 5 ? "Jummah" : "Dhuhr";
    }

    /* Date Picker */
    const picker = document.getElementById("datePicker");
    const todayISO = new Date().toISOString().slice(0, 10);
    picker.value = todayISO;
    updateJummahLabel(todayISO);

    picker.addEventListener("change", () => updateJummahLabel(picker.value));

    /* Prayer Logic (unchanged: heart, missed, fireworks) */
    let programmaticToggle = false;
    const ids = ["fajr", "dhuhr", "asr", "maghrib", "isha"];

    function togglePrayer(id, box, e) {
      const cb = document.getElementById(id);
      const directClick = e.target.closest("input,label");

      if (directClick) {
        setTimeout(checkAll, 0);
        return;
      }

      programmaticToggle = true;
      cb.checked = !cb.checked;

      if (cb.checked) showHeart(box);

      setTimeout(() => programmaticToggle = false, 0);
      checkAll();
    }

    ids.forEach(p => {
      document.getElementById(p).addEventListener("change", function () {
        if (!programmaticToggle && this.checked) showHeart(this.parentElement);
        checkAll();
      });
    });

    function showHeart(box) {
      const h = document.createElement("div");
      h.className = "heart";
      h.textContent = "â¤ï¸";
      box.appendChild(h);
      setTimeout(() => h.remove(), 1100);
    }

    function showMissed(box) {
      const m = document.createElement("div");
      m.className = "missedMsg";
      m.textContent = "Missed this Salah ðŸ’”";
      box.appendChild(m);
      setTimeout(() => m.remove(), 2500);
    }

    function checkAll() {
      const all = ids.every(id => document.getElementById(id).checked);
      const cont = document.querySelector(".container");

      if (all) {
        cont.classList.add("glowBox");
        confetti({ particleCount: 100, spread: 100, origin: { y: 0.7 } });
      } else {
        cont.classList.remove("glowBox");
      }
    }

    /* SAVE DAY */
    function resetDay() {
      let selectedDate = picker.value;
      let missed = [];
      let prayers = {};

      ids.forEach(p => {
        let c = document.getElementById(p).checked;
        prayers[p] = c;
        if (!c) missed.push(p);
      });

      let completedAll = missed.length === 0;

      let history = JSON.parse(localStorage.getItem("salahHistory") || "[]");

      history.push({
        dateISO: selectedDate,
        prayers,
        missed,
        completedAll
      });

      localStorage.setItem("salahHistory", JSON.stringify(history));

      ids.forEach(p => {
        if (!document.getElementById(p).checked)
          showMissed(document.getElementById(p).parentElement);

        document.getElementById(p).checked = false;
      });

      document.querySelector(".container").classList.remove("glowBox");

      if (completedAll) {
        confetti({ particleCount: 150, spread: 100, origin: { y: 0.7 } });
      }
    }

    function openHistory() {
      window.location.href = "history.html";
    }
  </script>

</body>

</html>
